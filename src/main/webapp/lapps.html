<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LappsGrid Visualization</title>

    <!-- =============================================================================================================== -->
    <!-- Bootstrap core CSS -->
    <link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="http://getbootstrap.com/dist/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="http://getbootstrap.com/examples/theme/theme.css" rel="stylesheet">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- =============================================================================================================== -->
    <link rel="stylesheet" href="http://codemirror.net/lib/codemirror.css">
    <link rel="stylesheet" href="http://codemirror.net/addon/scroll/simplescrollbars.css">
    <link rel="stylesheet" href="https://codemirror.net/addon/display/fullscreen.css">
    <link rel="stylesheet" href="https://codemirror.net/addon/dialog/dialog.css">
    <link rel="stylesheet" href="https://codemirror.net/addon/search/matchesonscrollbar.css">
    <link rel="stylesheet" href="https://codemirror.net/addon/fold/foldgutter.css" />
    <script src="http://codemirror.net/lib/codemirror.js"></script>
    <script src="http://codemirror.net/addon/scroll/simplescrollbars.js"></script>
    <!--<link rel=stylesheet href="http://codemirror.net/doc/docs.css">-->
    <script src="http://codemirror.net/mode/markdown/markdown.js"></script>
    <script src="http://codemirror.net/mode/xml/xml.js"></script>
    <script src="https://codemirror.net/addon/display/placeholder.js"></script>
    <script src="https://codemirror.net/addon/display/fullscreen.js"></script>
    <script src="https://codemirror.net/mode/javascript/javascript.js"></script>
    <script src="https://codemirror.net/addon/selection/active-line.js"></script>
    <script src="https://codemirror.net/addon/edit/matchbrackets.js"></script>
    <script src="https://codemirror.net/mode/xml/xml.js"></script>
    <!--<link rel="stylesheet" href="https://codemirror.net/theme/neat.css">-->
    <script src="https://codemirror.net/addon/mode/overlay.js"></script>
    <script src="https://codemirror.net/addon/mode/loadmode.js"></script>
    <script src="https://codemirror.net/mode/meta.js"></script>
    <script src="https://codemirror.net/mode/htmlmixed/htmlmixed.js"></script>
    <script src="https://codemirror.net/addon/display/placeholder.js"></script>
    <script src="https://codemirror.net/addon/dialog/dialog.js"></script>
    <script src="https://codemirror.net/addon/search/searchcursor.js"></script>
    <script src="https://codemirror.net/addon/search/search.js"></script>
    <script src="https://codemirror.net/addon/scroll/annotatescrollbar.js"></script>
    <!--  https://codemirror.net/demo/folding.html  -->
    <script src="https://codemirror.net/addon/fold/foldcode.js"></script>
    <script src="https://codemirror.net/addon/fold/foldgutter.js"></script>
    <script src="https://codemirror.net/addon/fold/brace-fold.js"></script>
    <script src="https://codemirror.net/addon/fold/xml-fold.js"></script>
    <script src="https://codemirror.net/addon/fold/markdown-fold.js"></script>
    <script src="https://codemirror.net/addon/fold/comment-fold.js"></script>
    <script src="https://codemirror.net/addon/search/matchesonscrollbar.js"></script>
    <script src="https://raw.githubusercontent.com/cfinke/Typo.js/master/typo/typo.js"></script>

    <!-- =============================================================================================================== -->
    <!-- Brat Visualisation ( http://brat.nlplab.org/embed.html#live) -->
    <link rel="stylesheet" type="text/css" href="http://brat.nlplab.org/css/style.css"/>
    <link rel="stylesheet" type="text/css" href="http://brat.nlplab.org/css/jquery-theme/jquery-ui-redmond.css"/>
    <link rel="stylesheet" type="text/css" href="http://weaver.nlplab.org/~brat/demo/v1.3/style-vis.css"/>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/lib/head.load.min.js"></script>
    <!-- =============================================================================================================== -->
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/lib/jquery.min.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/lib/jquery.svg.min.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/lib/jquery.svgdom.min.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/src/configuration.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/src/util.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/src/annotation_log.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/lib/webfont.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/src/dispatcher.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/src/url_monitor.js"></script>
    <script type="text/javascript" src="http://weaver.nlplab.org/~brat/demo/v1.3/client/src/visualizer.js"></script>
    <script type="text/javascript" src="http://brat.nlplab.org/js/lib/json2.js"></script>
    <script type="text/javascript" src="http://l2.io/ip.js?var=userip"></script>
    <!-- =============================================================================================================== -->
    <!--All the language services from Vassar College.-->
    <!--http://grid.anc.org:8080/service_manager/language-services-->

    <!-- =============================================================================================================== -->

    <!-- =============================================================================================================== -->
    <style type="text/css">
        .CodeMirror { border: 1px solid #aaa;font-size: 10pt;}
        .CodeMirror-empty { outline: 1px solid #c22; }
        .CodeMirror-empty.CodeMirror-focused { outline: none; }
        .CodeMirror pre.CodeMirror-placeholder { color: #999; }
        .modal-footer { background-color: #f9f9f9; }
        .btn-success { width: 100%; padding: 10px; }

        .dropdown-menu .dropdown-menu {
            position: static;
            float: none;
            padding: 5px 0;
            margin: 2px 0 0;
            list-style: none;
            font-size: 14px;
            background-color: #fff;
            border: none;
            border: none;
            border-radius: 0;
            -webkit-box-shadow: none;
            box-shadow:none;
            background-clip: padding-box;
        }
    </style>

    <!-- =============================================================================================================== -->

    <script type="text/javascript">
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< //
    var bratLocation = 'http://weaver.nlplab.org/~brat/demo/v1.3';
    /* head.js(
            // External libraries
                    bratLocation + '/client/lib/jquery.min.js',
                    bratLocation + '/client/lib/jquery.svg.min.js',
                    bratLocation + '/client/lib/jquery.svgdom.min.js',
            // brat helper modules
                    bratLocation + '/client/src/configuration.js',
                    bratLocation + '/client/src/util.js',
                    bratLocation + '/client/src/annotation_log.js',
                    bratLocation + '/client/lib/webfont.js',
            // brat modules
                    bratLocation + '/client/src/dispatcher.js',
                    bratLocation + '/client/src/url_monitor.js',
                    bratLocation + '/client/src/visualizer.js',

            // json2
            'http://brat.nlplab.org/js/lib/json2.js'
    );  */
    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< //
    var webFontURLs = [
                bratLocation + '/static/fonts/Astloch-Bold.ttf',
                bratLocation + '/static/fonts/PT_Sans-Caption-Web-Regular.ttf',
                bratLocation + '/static/fonts/Liberation_Sans-Regular.ttf'
    ];

    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  //

    var formatXml = function(xml) {
        var formatted = '';
        var reg = /(>)(<)(\/*)/g;
        xml = xml.replace(reg, '$1\r\n$2$3');
        var pad = 0;
        jQuery.each(xml.split('\r\n'), function(index, node) {
        var indent = 0;
        if (node.match( /.+<\/\w[^>]*>$/ )) {
            indent = 0;
        } else if (node.match( /^<\/\w/ )) {
            if (pad != 0) {
                pad -= 1;
            }
        } else if (node.match( /^<\w[^>]*[^\/]>.*$/ )) {
            indent = 1;
        } else {
            indent = 0;
        }

        var padding = '';
        for (var i = 0; i < pad; i++) {
            padding += ' ';
        }

        formatted += padding + node + '\r\n';
            pad += indent;
        });

        return formatted;
    }

    var escapeXml = function(unsafe) {
        return unsafe.replace(/[<>&'"]/g, function (c) {
            switch (c) {
                case '<': return '&lt;';
                case '>': return '&gt;';
                case '&': return '&amp;';
                case '\'': return '&apos;';
                case '"': return '&quot;';
            }
        });
    }

    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  //
    var changeMode = function(editor, value) {
      if (value.trim().substr(0, 1) == "{" && editor.getOption("mode") != "javascript") {
        editor.setOption("mode", "javascript");
        CodeMirror.autoLoadMode(editor, "javascript");
      }
    }

    var codeMirrors = {};

    var coverCodeMirror = function(textareaId, changeHandler) {
        var textarea = document.getElementById(textareaId);
        var editor = CodeMirror.fromTextArea(textarea, {
            mode: "javascript",
            lineNumbers: true,
            lineWrapping: true,
            styleActiveLine: true,
            matchBrackets: true,
            scrollbarStyle: "overlay",
            foldGutter: true,
            gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
        });
        // editor.setOption("theme", "neat");
        editor.setSize(textarea.style.width, textarea.style.height);
        codeMirrors[textareaId] = editor;
        editor.on('dblclick', function() {
            editor.setOption("fullScreen", !editor.getOption("fullScreen"));
        });
        editor.on("viewportChange", function(){
            editor.refresh();
        });
        return editor;
    }

    var getCodeMirrorValue = function(textareaId) {
        return codeMirrors[textareaId].getValue();
    }

    var setCodeMirrorValue = function(textareaId, val) {
        codeMirrors[textareaId].setValue(val);
    }

    var docChangeHandler = function(liveDispatcher, textareaId){
        var docInput = getCodeMirrorValue(textareaId);
        var docJSON;
        try {
            docJSON = JSON.parse(docInput.trim());
            // docInput.css({'border': '2px inset'});
        } catch (e) {
            // docInput.css({'border': '2px solid red'});
            console.error('invalid JSON Data:', e);
            return;
        }
        try {
            liveDispatcher.post('requestRenderData', [$.extend({}, docJSON)]);
            console.info("docChangeHandler");
            // liveDiv.css({'border': '2px inset'});  // setting this blows the layout
            // collInput.css({'border': '2px inset'});
        } catch(e) {
            console.error('requestRenderData went down with:', e);
            // liveDiv.css({'border': '2px solid red'});
            // collInput.css({'border': '2px solid red'});
        }
    }


    var confChangeHandler = function(liveDispatcher, textareaId) {
        var collInput = getCodeMirrorValue(textareaId);
        var collJSON;
        try {
            collJSON = JSON.parse(collInput.trim());
            // collInput.css({'border': '2px inset'});
        } catch (e) {
            // Not properly formatted JSON...
            // collInput.css({'border': '2px solid red'});
            console.error('invalid JSON Data:', e);
            return;
        }
        try {
            liveDispatcher.post('collectionLoaded',
                    [$.extend({'collection': null}, collJSON)]);
            console.info("confChangeHandler");
            // liveDiv.css({'border': '2px inset'});  // setting this blows the layout
            // docInput.css({'border': '2px inset'});
        } catch(e) {
            console.error('collectionLoaded went down with:', e);
            //liveDiv.css({'border': '2px solid red'});
            // collInput.css({'border': '2px solid red'});
        }
    }

    var renderBratDisplay =  function (displayId, inputId, confInputId) {
        var docData = getCodeMirrorValue(inputId);
        var collData = getCodeMirrorValue(confInputId);
        // Time for some "real" brat coding, let's hook into the dispatcher
        var liveDispatcher;
        try{
            liveDispatcher = Util.embed(displayId,
                $.extend({'collection': null}, JSON.parse(collData.trim())),
                $.extend({}, JSON.parse(docData.trim())), webFontURLs);
            console.info("Finished: liveDispatch");
        }catch(e) {
            console.error("ERROR: "+e+" ;doc="+docData+"; coll="+collData);
        }
        var renderError = function() {
            // setting this blows the layout (error --> red)
            $('#' + displayId).css({'border': '2px solid red'});
        };
        liveDispatcher.on('renderError: Fatal', renderError);

        codeMirrors[inputId].on('change', function() {
            docChangeHandler(liveDispatcher, inputId);
        });

        codeMirrors[confInputId].on('change', function() {
            confChangeHandler(liveDispatcher, confInputId);
        });

        // packJSON used to make json neat and pack.
        var packJSON = function(s) {
            // replace any space with ' ' in non-nested curly brackets
            s = s.replace(/(\{[^\{\}\[\]]*\})/g,
                          function(a, b) { return b.replace(/\s+/g, ' '); });
            // replace any space with ' ' in [] up to nesting depth 1
            s = s.replace(/(\[(?:[^\[\]\{\}]|\[[^\[\]\{\}]*\])*\])/g,
                          function(a, b) { return b.replace(/\s+/g, ' '); });
            return s
        }
        // when input doc data changed
        // liveDispatcher.post('requestRenderData', [$.extend({}, JSON.parse(docInput.val()))]);

        // when config input coll data changed
        // liveDispatcher.post('collectionLoaded',  [$.extend({'collection': null}, JSON.parse(collInput.val()))]);
    }

    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  //
    var wsdls = {
        json2json : 'http://eldrad.cs-i.brandeis.edu:8282/json2json/0.3.0-SNAPSHOT/services/Json2JsonWS?wsdl'
    }


    var execJava = function (classname, op, inputs, callback) {
        var io = {};
        io.ClassName = classname;
        io.Op = op
        io.Input = inputs
        // clear outputId value
        var req = {};
        req.io = JSON.stringify(io);
        $.ajax({
            type: "POST",
            dataType: "text",
            url: "execjava.groovy",
            data: req,
            success: function(data, dataType) {
              var resJson = jQuery.parseJSON(data);
              callback(resJson.Output);
              if (resJson.Output) {
                 // console.info("RET:" + resJson.Output);
              }
              if(resJson.Except.indexOf('Success') < 0) {
                //
                console.error("Server Error:" + resJson.Except);
              }else{
                //
              }
            },
            error: function(x, t, m) {
                console.error("ERROR:" + x);
            }
        });
    }

    var holdDB = {};
    var readDB = function(key, callback) {
        execJava('org.jldservice.db.Jdbm', 'get', ['lapps.html', key], function(ret){
            var json;
            if(ret){
                json = jQuery.parseJSON(ret);
                holdDB[key] = json;
            }
            callback(json);
        });
    }
    var saveDB = function(key, json, callback) {
        json = json || holdDB[key];
        var s = JSON.stringify(json,null,4);
        execJava('org.jldservice.db.Jdbm', 'put', ['lapps.html', key, s], function(ret){
            callback(ret);
        });
    }

    var selectTool = function(spanId, service, wsdl) {
        $("#"+spanId).text(service);
        $("#"+spanId).prop('title', wsdl);
    }

    var selectData = function(selectedinputId, datajsonId) {
        var lastdata = holdDB['lastdataselect'];
        $("#"+selectedinputId).text(lastdata.name +" < "+lastdata.time+" >");
        $("#"+selectedinputId).prop("title", datajsonId);
        setCodeMirrorValue(datajsonId, lastdata.output);
    }

    var genResultList = function(panelDivId) {
        var panelDiv = $("#"+ panelDivId);
        readDB("results"+userip, function(resultJson){
            if(!resultJson)
                return;
            var jsonAllList = resultJson[userip];
            //console.info("userip" + userip);
            var html = "";
            for(var wsdl in jsonAllList) {
                //console.info("wsdl" + wsdl);
                var lists = jsonAllList[wsdl];
                if(lists && lists.length > 0) {
                    var name = lists[0]['name'];
                    var id = name.replace(/\s+/g, '_').toLowerCase();
                    html += "<div class='dropdown'><button class='btn btn-default dropdown-toggle' type='button' id='"+ id +"' data-toggle='dropdown' aria-expanded='true'>"
                    html += name + "<span class='caret'></span></button>";
                    html += "<ul class='dropdown-menu' role='menu' aria-labelledby='"+id+"'>";
                    lists.map( function(record) {
                        holdDB['lastdataselect'] = record;
                        html += "<li role='presentation' onclick='selectData(\"selectedinput\",\"datajson\")'>"
                        html += "<a role='menuitem' tabindex='-1' href='#'>"+record['time']+"</a></li>"
                    });
                    html += "</ul></div>";
                }
            }
            panelDiv.html(html);
        });
    }

    var genPanelHTML = function(name, jsonOneType, parentDivId, panelDivId) {
        html = "<div class='panel panel-info'>";
        html += "<div class='panel-heading'><h4 class='panel-title'>";
        html += "<a class='collapsed' data-toggle='collapse' aria-expanded='false' data-parent='#" +
                parentDivId + "' href='#"+panelDivId+"'>"+name+"</a>";
        html += "</h4></div>";
        html += "<div id='"+panelDivId+"' class='panel-collapse collapse'>";
        for (var provider in jsonOneType) {
            html += "<div class='panel panel-default'>";
            var services = jsonOneType[provider];
            html += "<button type='button' class='btn btn-default'> "+provider+" <span class='badge'>" +
                     services.length + "</span></button> <span style='width:20px;'></span>"
            // iterate over array.
            services.map(function(service){
                html += " <label class='radio-inline'>";
                var showname = service['name'] +":"+service['version'] + " ( "+service['server']+" ) ";
                html += "<input type='radio' name='optradio' onclick='selectTool(\"selectedtool\",\""+showname+"\",\""+service['wsdl'] +"\")' >";
                html += showname
                html += "</label>";
            });
            html += "</div>";
        }
        html += "</div>";
        html += "</div>";
        return html;
    }


    var genToolList = function(panelgroupDivId) {
        var panelgroupDiv = $("#"+ panelgroupDivId);
        panelgroupDiv.attr("class", "panel-group");
        readDB("services", function(servicesJson){
            var jsonAllTypes = servicesJson['ServiceTypes'];
            for(var typename in jsonAllTypes) {
                if(Object.keys(jsonAllTypes[typename]).length == 0)
                    continue;
                var panel = genPanelHTML(typename, jsonAllTypes[typename], panelgroupDivId, typename);
                panelgroupDiv.append(panel);
            }
        });
        panelgroupDiv.hide().fadeIn('fast');
    }

    var text2lappsjson = function(txt) {
        txt = txt.trim();
        if (txt.indexOf("{") == 0 && txt.lastIndexOf("}") ==txt.length-1) {
            return txt;
        } else {
            var json = {};
            json.discriminator = "http://vocab.lappsgrid.org/ns/media/text";
            json.payload = txt;
            return JSON.stringify(json);
        }
    }

    var execService = function (wsdl, op, inputIds, outputId) {
        var io = {};
        io.Wsdl = wsdl;
        io.Op = op
        io.Input = [];
        // push inputId value into io input
        for (var i = 0; i < inputIds.length; i++) {
            io.Input.push(text2lappsjson(getCodeMirrorValue(inputIds[i])));
        }
        if(wsdl.indexOf('grid.anc') >= 0) {
            io.Username = 'tester';
            io.Password = 'tester';
        }
        // clear outputId value
        setCodeMirrorValue(outputId, '')

        var req = {};
        req.io = JSON.stringify(io);
        $.ajax({
            type: "POST",
            dataType: "text",
            url: "callservice.groovy",
            data: req,
            success: function(data, dataType) {
              var resJson = jQuery.parseJSON(data);
              if (resJson.Output) {
                    setCodeMirrorValue(outputId, JSON.stringify(jQuery.parseJSON(resJson.Output),null,4));
              }
              if(resJson.Except.indexOf('Success') < 0) {
                console.error("Server Error:" + resJson.Except);
                $("#runalert").html("<div  class='alert alert-warning' role='alert'><strong>Service Error!</strong>  <a href='#' class='alert-link'>Exception:</a> "+ resJson.Except + "</div>");
                    setTimeout(function(){
                        $("#runalert").html("");
                    }, 20000);
              } else {
                $("#runalert").html("<div  class='alert alert-success' role='alert'><strong>Well done!</strong> You successfully exec <a href='#' class='alert-link'>the service</a>.</div>");
                setTimeout(function(){
                    $("#runalert").html("");
                }, 5000);
              }
             }
        });
    }


    var runTool = function(selectedinputId, selectedtoolId, resultjsonId) {
        var inputTxtId = $("#"+selectedinputId).prop( "title" );
        var wsdl = $("#"+selectedtoolId).prop( "title" );
        if(inputTxtId && wsdl) {
            execService(wsdl, 'execute', [inputTxtId], resultjsonId);
            var inputTxt = getCodeMirrorValue(inputTxtId);
            holdDB['latesttoolrun'] = {time:new Date().toLocaleString(), name:$("#"+selectedtoolId).text(), wsdl:wsdl, input:inputTxt};
        }
     }

     var saveResult = function(selectedinputId, selectedtoolId, resultjsonId, alertDivId){
        var result = holdDB['latesttoolrun'];
        result.output = getCodeMirrorValue(resultjsonId);
        if(!result.output) {
            $("#"+alertDivId).html("<div  class='alert alert-warning' role='alert'><strong>NO Result!</strong> Run  <a href='#' class='alert-link'>the data</a> again.</div>");
                setTimeout(function(){
                    $("#"+alertDivId).html("");
                }, 5000);
            return;
        }
        readDB("results"+userip, function(resultJson){
            var userjson, tooljsons;
            if(resultJson) {
                userjson = resultJson[userip];
            } else {
                resultJson = {}
            }
            if(userjson) {
                tooljsons = userjson[result.wsdl];
            } else {
                userjson = {}
            }
            if(!tooljsons) {
                tooljsons = [];
            }
            tooljsons.push(result);
            userjson[result.wsdl] = tooljsons;
            resultJson[userip] = userjson;
            saveDB("results"+userip, resultJson, function(ret){
                $("#"+alertDivId).html("<div  class='alert alert-success' role='alert'><strong>Well done!</strong> You successfully save <a href='#' class='alert-link'>the data</a>.</div>");
                setTimeout(function(){
                    $("#"+alertDivId).html("");
                }, 5000);
                genResultList('previousdatapanel');
            });
        });
     }

    var loadLappsServices = function(textareaId, accountId, passwordId) {
        setCodeMirrorValue(textareaId, "");
        if($("#"+accountId).val() == "brandeis" && $("#"+accountId).val() == "brandeis") {
            readDB("services", function(servicesJson){
                var txt = JSON.stringify(servicesJson,null,4);
                setCodeMirrorValue(textareaId, txt);
            });
        }
    }

    var saveLappsServices = function(textareaId, accountId, passwordId, alertDivId) {
        var txt = getCodeMirrorValue(textareaId);
        var json = JSON.parse(txt);
        if($("#"+accountId).val() == "brandeis" && $("#"+accountId).val() == "brandeis") {
            saveDB("services",json, function(ret){
                $("#"+alertDivId).html("<div  class='alert alert-success' role='alert'><strong>Well done!</strong> You successfully save <a href='#' class='alert-link'>the data</a>.</div>");
                setTimeout(function(){
                    $("#"+alertDivId).html("");
                }, 5000);
            });
        }
    }
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< //
    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //
    head.ready(function() {
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< //

        ///////////////////////////////////////////////////////////////////////////////////
        //        Header.                                                                //
        ///////////////////////////////////////////////////////////////////////////////////
        // Evaluate the code from the examples and show it to the user
        /* Make damn sure to copy the objects before handing them to brat
         since we will modify them later on */

        renderBratDisplay("instantbratdisplay", "docjson", "colljson");
        // onchange setting.
        codeMirrors['resultjson'].on('change', function() {
            if(getCodeMirrorValue('resultjson').indexOf('@value') > 0)
                execService(wsdls['json2json'], 'json2jsondsl', ['resultjson', 'json2jsondsl_template'], 'docjson')
        });

        var jquery2 = jQuery.noConflict( true );
    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //
    });  // {head.ready}
    // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  //
    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //



</script>

    <!-- =============================================================================================================== -->
</head>

<h1  align="center">Online Environment of LappsGrid</h1>
<p style="text-align:center;font-size: 16pt;">
    <rt> Brandeis University</rt>,<br />
    LappsGrid, <var>Version 0.3.0</var>,  April 2015</p>

<!-- =============================================================================================================== -->

<h2 align="center">
    <span class="label label-primary" style="width:800px;display:inline-block;">
    LappsGrid Input
</span></h2>



<!-- =============================================================================================================== -->
<!-- =============================================================================================================== -->


<!--------------------------------------------------------------------------------------------------------------------->
<!--<h2 align="center"><span class="label label-primary" style="width:800px;display:inline-block;">Document Text</span></h2>-->
<table align="center">
    <tr><td>

<!--------------------------------------------------------------------------------------------------------------------->
        <div style="display: block; margin-left: auto; margin-right: auto">
            <div class="dropdown">
                <button class="btn btn-info dropdown-toggle" id="menu1" type="button" data-toggle="dropdown">Input Type <span class="caret"></span></button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
                    <li role="presentation"><a onclick="genResultList('previousdatapanel')" role="menuitem" tabindex="-1" data-toggle="collapse" data-parent="#selectinput" href="#datainput">Privous Output >></a></li>
                    <li role="presentation" class="divider"></li>
                    <li role="presentation"><a onclick="$('#selectedinput').text('Document');$('#selectedinput').prop('title', 'doctext');" role="menuitem" tabindex="-1" data-toggle="collapse" data-parent="#selectinput" href="#textinput">Text Document >></a></li>
                </ul>
            </div>
        </div>
<!--------------------------------------------------------------------------------------------------------------------->
    </td><td width="20px"></td><td>
<!--------------------------------------------------------------------------------------------------------------------->
        <div class="panel-group" id="selectinput">
            <div class="panel panel-default">
                <div id="textinput" class="panel-collapse collapse in">
                    <div class="panel-body">
                        <!--.............................................................................................................--->
                        <table><tr><td>
                        <textarea id="doctext" style="width:800px">p53 regulates human insulin-like growth factor II gene expression through active P4 promoter in rhabdomyosarcoma cells.</textarea> <script>coverCodeMirror("doctext");</script></td>
                            <td width="20px"></td><td width="160px">
                                <dl>
                                    <dt>Ctrl-F / Cmd-F</dt><dd>Start searching</dd><dt>Ctrl-G / Cmd-G</dt><dd>Find next</dd>
                                    <dt>Shift-Ctrl-G / Shift-Cmd-G</dt><dd>Find previous</dd>
                                    <dt>Shift-Ctrl-F / Cmd-Option-F</dt><dd>Replace</dd>
                                    <dt>Shift-Ctrl-R / Shift-Cmd-Option-F</dt><dd>Replace all</dd>
                                </dl></td>
                        </tr></table>
                        <!--.............................................................................................................--->
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div id="datainput" class="panel-collapse collapse">
                    <div class="panel-body">
                        <!--.............................................................................................................--->
                        <table><tr><td>Please Select: </td><td><div id="previousdatapanel"></div></td></tr><tr><td colspan="2"><p></p></td></tr><tr>
                            <td colspan="2">
                            <textarea id="datajson"  style="width:800px"></textarea> <script>coverCodeMirror("datajson");</script>
                            </td>
                        </tr></table>
                        <!--.............................................................................................................--->
                    </div>
                </div>
            </div>
        </div>
    </td></tr></table>
<!--------------------------------------------------------------------------------------------------------------------->

<!--------------------------------------------------------------------------------------------------------------------->


<!--------------------------------------------------------------------------------------------------------------------->


<!-- =============================================================================================================== -->

<!-- =============================================================================================================== -->

<div class="container">
    <h2 align="center"><span class="label label-primary" style="width:800px;display:inline-block;">LappsGrid Tools</span></h2>
    <div class="panel-group" id="lappstools"></div><script> genToolList('lappstools')</script>
</div>


<table class="table table-bordered table-striped responsive-utilities" align="center" style="width:800px">
    <thead>
    <tr >
        <th style="text-align:center">Data</th>
        <th style="text-align:center">Tool Service</th>
        <th style="text-align:center">Execute</th>
    </tr>
    </thead>
    <tbody>
    <tr align="center">
        <td class="is-visible" width="400px"><h4><span id="selectedinput" class="label label-info" title="doctext">Document</span></h4></td>
        <td class="is-visible" width="300px"><h4><span id="selectedtool" class="label label-info">Select a tool above ^</span></h4></td>
        <td class="is-visible">
            <button type="button" class="btn btn-default"
                    onclick="runTool('selectedinput', 'selectedtool', 'resultjson');">
            <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Run >>
        </button></td>
    </tr>
    <tr><td colspan="3" height="50px"><p><div id="runalert"></div></p></td></tr>
    </tbody>
</table>



<h2 align="center"><span class="label label-primary" style="width:800px;display:inline-block;">LappsGrid Result</span></h2>

<div class="container" id="resultpanel">
    <table align="center" class="table table-bordered table-striped responsive-utilities" align="center" style="width:800px;">
        <tr><th> Brat Display </th></tr>
        <tr><td height="100px"><div id="instantbratdisplay"></div></td></tr>
    </table>
    <table align="center" class="table table-bordered table-striped responsive-utilities" align="center" style="width:800px">
        <tr><th>Tool Output</th> <th> Save Output </th> </tr>
        <tr><td>
        <textarea id="resultjson" style="width:600px"></textarea><script>coverCodeMirror("resultjson");</script>
        </td> <td><button type="button" class="btn btn-default"
                                  onclick="saveResult('selectedinput', 'selectedtool', 'resultjson', 'savealert');">
                <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Save Result >>
            </button></td></tr>
        <tr><td colspan="2" height="50px"><p><div id="savealert"></div></p></td></tr>
    </table>
</div>

<!-- =============================================================================================================== -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
<!-- ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| -->
<!-- =============================================================================================================== -->

<!-- =============================================================================================================== -->
<div style="display:none">
<h2 align="center"><span class="label label-primary" style="width:800px;display:inline-block;">LappsGrid JSON 2 Brat JSON</span></h2>
<p>
<table align="center">
    <tr> <th>Source:</th> <th>Template DSL:</th><th> </th><th>Result:</th> </tr>
    <tr>
        <td><textarea id="json2jsondsl_source" style="width:400px;height:300px;">{}</textarea><script>coverCodeMirror("json2jsondsl_source");</script>
        </td>
        <td><textarea id="json2jsondsl_template" style="width:400px;height:300px;">{
  def idx = 0
  def parse = &$payload.views[-1].annotations.features[0].penntree
  text &$payload.text."@value" + (parse == null?"":"\n\n\n"+parse)
  entities (&$payload.views[-1].annotations.unique{it.start+" "+it.end}.select{&.features != null && (&.features.category != null || &.features.pos != null)}.foreach{
    [&.id == null?"T${idx++}":&.id, &.features.category != null?&.features.category.trim().toUpperCase():&.features.pos.trim().toUpperCase(), [[&.start.toInteger(), &.end.toInteger()]]]
  })
  relations (&$payload.views[-1].annotations.select{&.type=="http://vocab.lappsgrid.org/DependencyStructure"}.features.dependencies
             .flatten().foreach{
             [&.id, &.label, [["Governor", &.features.governor], ["Dependent", &.features.dependent]]]
             })
}</textarea><script>coverCodeMirror("json2jsondsl_template");</script></td>
        <td><input type="button" value="Transform"
                   onclick="execService(wsdls['json2json'], 'json2jsondsl', ['json2jsondsl_source', 'json2jsondsl_template'], 'json2jsondsl_result')" /></td>
        <td><textarea  id="json2jsondsl_result"  style="width:400px;height:300px;"></textarea>
            <script>coverCodeMirror("json2jsondsl_result");</script></td>
    </tr>
</table>

<hr/>
</div>
<!-- =============================================================================================================== -->
<div style="display:none">
<h2 align="center"><span class="label label-primary" style="width:800px;display:inline-block;">Brat JSON Visualization</span></h2>

<table align="center">
    <tr> <th>Brat DOC JSON:</th> <th>Brat CONFIG JSON:</th><th></tr>
    <tr> <td>
    <textarea id="docjson" style="width:600px">{}</textarea><script>coverCodeMirror("docjson");</script></td>
        <td>
            <!--https://github.com/nlplab/brat/blob/master/configurations/Stanford-CoreNLP/visual.conf-->
        <textarea id="colljson" style="width:600px">{
  "entity_types": [
    {
      "type": "PERSON",
      "labels": ["Person", "Per" ],
      "bgColor": "#ffccaa",
      "borderColor": "darken"
    },
    {
      "type": "TIME",
      "labels": [ "Time" ],
      "bgColor": "#ffccaa",
      "borderColor": "darken"
    },
    {
      "type": "NUMBER",
      "labels": [ "Number", "Num" ],
      "bgColor": "#ffccaa",
      "borderColor": "darken"
    },
    {
      "type": "DATE",
      "labels": [ "Date" ],
      "bgColor": "#ffccaa",
      "borderColor": "darken"
    },
    {
      "type": "LOCATION",
      "labels": [ "Location", "Loc"],
      "bgColor": "#f1f447",
      "borderColor": "darken"
    },
    {
      "type": "ORGANIZATION",
      "labels": [ "Organization", "Org"],
      "bgColor": "#8fb2ff",
      "borderColor": "darken"
    },
    {
      "type": "GENE",
      "labels": [ "Gene", "Gen" ],
      "bgColor": "#95dfff",
      "borderColor": "darken"
    },
    {
      "type": "-LRB-",
      "labels": ["-LRB-"],
      "bgColor": "#e3e3e3",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "-RRB-",
      "labels": ["-RRB-"],
      "bgColor": "#e3e3e3",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "DT",
      "labels": ["DT"],
      "bgColor": "#ccadf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "PDT",
      "labels": ["PDT"],
      "bgColor": "#ccadf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "WDT",
      "labels": ["WDT"],
      "bgColor": "#ccadf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "CD",
      "labels": ["CD"],
      "bgColor": "#ccdaf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "NP",
      "labels": ["NP"],
      "bgColor": "#7fa2ff",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "NN",
      "labels": ["NN"],
      "bgColor": "#a4bced",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "NNP",
      "labels": ["NNP"],
      "bgColor": "#a4bced",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "NNPS",
      "labels": ["NNPS"],
      "bgColor": "#a4bced",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "NNS",
      "labels": ["NNS"],
      "bgColor": "#a4bced",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "VP",
      "labels": ["VP"],
      "bgColor": "lightgreen",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "MD",
      "labels": ["MD"],
      "bgColor": "#adf6a2",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "VB",
      "labels": ["VB"],
      "bgColor": "#adf6a2",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "VBZ",
      "labels": ["VBZ"],
      "bgColor": "#adf6a2",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "VBP",
      "labels": ["VBP"],
      "bgColor": "#adf6a2",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "VBN",
      "labels": ["VBN"],
      "bgColor": "#adf6a2",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "VBG",
      "labels": ["VBG"],
      "bgColor": "#adf6a2",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "VBD",
      "labels": ["VBD"],
      "bgColor": "#adf6a2",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "PP",
      "labels": ["PP"],
      "bgColor": "lightblue",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "PRP",
      "labels": ["PRP"],
      "bgColor": "#ccdaf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "RB",
      "labels": ["RB"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "RBR",
      "labels": ["RBR"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "RBS",
      "labels": ["RBS"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "WRB",
      "labels": ["WRB"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "WP",
      "labels": ["WP"],
      "bgColor": "#ccdaf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "ADVP",
      "labels": ["ADVP"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "SBAR",
      "labels": ["SBAR"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "ADJP",
      "labels": ["ADJP"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "JJ",
      "labels": ["JJ"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "JJS",
      "labels": ["JJS"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "JJR",
      "labels": ["JJR"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "PRT",
      "labels": ["PRT"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "CONJP",
      "labels": ["CONJP"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "TO",
      "labels": ["TO"],
      "bgColor": "#ffe8be",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "IN",
      "labels": ["IN"],
      "bgColor": "#ffe8be",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "INTJ",
      "labels": ["INTJ"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "EX",
      "labels": ["EX"],
      "bgColor": "#e4cbf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "FW",
      "labels": ["FW"],
      "bgColor": "#e4cbf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "LS",
      "labels": ["LS"],
      "bgColor": "#e4cbf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "POS",
      "labels": ["POS"],
      "bgColor": "#e4cbf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "RP",
      "labels": ["RP"],
      "bgColor": "#e4cbf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "SYM",
      "labels": ["SYM"],
      "bgColor": "#e4cbf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "UH",
      "labels": ["UH"],
      "bgColor": "#e4cbf6",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "LST",
      "labels": ["LST"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "MENTION",
      "labels": ["Mention"],
      "bgColor": "lightgray",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "B-DNA",
      "labels": ["B-DNA", "BDNA"],
      "bgColor": "#a4bced",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "I-DNA",
      "labels": ["I-DNA", "IDNA"],
      "bgColor": "#a4bced",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "B-PROTEIN",
      "labels": ["B-PROTEIN", "B-PRO", "BPRO"],
      "bgColor": "#ffe8be",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "I-PROTEIN",
      "labels": ["I-PROTEIN", "I-PRO", "IPRO"],
      "bgColor": "#ffe8be",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "B-CELL_TYPE",
      "labels": ["B-CELL_TYPE","B-CELL", "BCELL"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "I-CELL_TYPE",
      "labels": ["B-CELL_TYPE","I-CELL", "ICELL"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "DNA",
      "labels": ["DNA"],
      "bgColor": "#a4bced",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "PROTEIN",
      "labels": ["PROTEIN", "PROT"],
      "bgColor": "#ffe8be",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "CELL_TYPE",
      "labels": ["CELL-TYPE","CELL-T"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    },
    {
      "type": "CELL_LINE",
      "labels": ["CELL_LINE","CELL-L"],
      "bgColor": "#fffda8",
      "borderColor": "darken",
      "fgColor": "black"
    }
  ],
  "entity_attribute_types": [],
  "relation_types": [
    {
      "args": [
        {
          "role": "Arg1",
          "targets": [
            "Mention"
          ]
        },
        {
          "role": "Arg2",
          "targets": [
            "Mention"
          ]
        }
      ],
      "arrowHead": "none",
      "name": "Coref",
      "labels": ["Coreference", "Coref"],
      "children": [],
      "unused": false,
      "dashArray": "3,3",
      "attributes": [],
      "type": "COREFERENCE",
      "properties": {
        "symmetric": true,
        "transitive": true
      }
    },
    {
      "type"     : "COREFERENCE_1",
      "labels"   : ["Coreference", "Coref"],
      "dashArray": "3,3",
      "color"    : "purple",
      "args"     : [
        {"role": "Representative", "targets": ["MENTION"] },
        {"role": "Mention",  "targets": ["MENTION"] }
      ]
    }
  ],
  "event_types": [
    {
      "borderColor": "darken",
      "normalizations": [],
      "name": "Mention",
      "arcs": [
        {
          "arrowHead": "none",
          "dashArray": "3,3",
          "labels": [
            "Coref"
          ],
          "type": "Coreference",
          "targets": [
            "Mention"
          ]
        }
      ],
      "labels": [
        "Mention",
        "Ment",f
        "M"
      ],
      "unused": false,
      "bgColor": "#ffe000",
      "attributes": [],
      "type": "Mention",
      "children": []
    }
  ]
}</textarea><script>coverCodeMirror("colljson");</script>
    </td></tr>
    <tr><td colspan="2"><div id="___bratdisplay___"></div></td></tr>
</table>
<!-- =============================================================================================================== -->

<!-- =============================================================================================================== -->

<div class="container">
    <h2 align="center"><span class="label label-primary" style="width:800px;display:inline-block;">Visualization by Brat</span></h2>

</div>

<p></p>
<p></p>
</div>
<!-- =============================================================================================================== -->

<h6>
    <span class="glyphicon glyphicon-apple" aria-hidden="true" ondblclick="$('#servicesupdate').toggle()"></span>
</h6>

<div id="servicesupdate" style="display:none">
    <h2 align="center">
    <span class="label label-primary" style="width:800px;display:inline-block;">
    Lapps Service Update</span></h2>
    <table align="center">
        <tr><td><span class="label label-primary">UserName</span>
            <input type="text" id="account"></td><td>
            <span class="label label-primary">PassWord</span><input type="password" id="password"></td></tr>
        <tr><td colspan="2">
            <textarea id="servicesjson"  style="width:800px"></textarea> <script>coverCodeMirror("servicesjson");</script>
        </td></tr>
        <tr><td><button type="button" class="btn btn-default"
                        onclick="loadLappsServices('servicesjson', 'account','password');">
            <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Load Services
        </button></td>
            <td><button type="button" class="btn btn-default"
                        onclick="saveLappsServices('servicesjson', 'account','password','saveservicesalert');">
                <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Save Services
            </button></td></tr>
        <tr><td colspan="2" height="50px"><p><div id="saveservicesalert"></div></p></td></tr>
    </table>
</div>

<!-- =============================================================================================================== -->
<!-- =============================================================================================================== -->
<footer>
    <hr />
    <p style="text-align:center">
        Contacts:
        <br/>&nbsp; &nbsp; <a target="_blank" class="nolink" href="http://www.cs.brandeis.edu/~jamesp/"> James Pustejovsky</a>
        (<nonsense>jame</nonsense>sp@<nonsense>cs.</nonsense>brandeis.<nonsense></nonsense>edu)
    </p>
</footer>
<p style="text-align:center">Copyright &copy; 2015 Brandeis University - All Rights Reserved</p>
</body>
</html>